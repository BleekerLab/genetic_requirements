facet_wrap(~background)+
theme_bw()
plot(typeVI_I_IV_scatter)
plot_ly(df, x=df$TypeIandIV,
y=df$sum_type_VI,
z=df$NonGlandular,
type="scatter3d",
mode="markers",
color=df$background)
plot_ly(df, x=df$TypeIandIV,
y=df$sum_type_VI,
z=df$NonGlandular,
type="scatter3d",
mode="markers",
color=df$background)
typeVI_non_glandular_scatter =
df %>% #filter(., background == "F2") %>%
ggplot(.,
aes(
x = sum_type_VI,
y = NonGlandular
)
) +
geom_point(position = "jitter",
aes(colour = background),
alpha = 1) +
geom_smooth(method = "lm")+
facet_wrap(~background)+
theme_bw()
plot(typeVI_non_glandular_scatter)
str(df)
df = read.csv(file = "trichomes full F2 PI127826 CSV.csv", sep = ";", header = T)
df = read.csv(file = "Figure_2/trichomes full F2 PI127826 CSV.csv", sep = ";", header = T)
str(df)
typeVI_I_IV_scatter =
df %>% #filter(., background == "F2") %>%
ggplot(.,
aes(
x = sum_type_VI,
y = TypeIandIV
)
) +
geom_point(position = "jitter",
aes(colour = background),
alpha = 1) +
geom_smooth(method = "lm")+
facet_wrap(~background)+
theme_bw()
plot(typeVI_I_IV_scatter)
plot_ly(df, x=df$TypeIandIV,
y=df$sum_type_VI,
z=df$NonGlandular,
type="scatter3d",
mode="markers",
color=df$background)
# Scatterplot type-VI vs Non-glandular
typeVI_non_glandular_scatter =
df %>% #filter(., background == "F2") %>%
ggplot(.,
aes(
x = sum_type_VI,
y = NonGlandular
)
) +
geom_point(position = "jitter",
aes(colour = background),
alpha = 1) +
geom_smooth(method = "lm")+
facet_wrap(~background)+
theme_bw()
plot(typeVI_non_glandular_scatter)
df.long =
gather(df,
key = "trichome_type",
value = "class",
-plant, -surface, -background, -name, -date)
df.long$class = as.integer(df.long$class)
df.long %>% filter(., trichome_type %in% c("NonGlandular", "sum_type_VI", "TypeIandIV")) %>%
ggplot(., aes(x = class)) +
geom_histogram(fill = "grey")+
facet_grid(background~trichome_type, scale = "free")+
#geom_density(alpha=.2, fill="#FF6666") +
theme_bw()
df = read.csv("Figure_2/GCMS_Leafwash_Full_F2_EZ.csv",1,header = TRUE)
df.parsed = filter(df, df$group == "F2")
head(df.parsed)
ggplot(df.parsed, aes(x= df.parsed$pinene, y=df.parsed$zingiberene)) +
geom_point() +
scale_x_continuous(trans='log10') + #Log10 scale
scale_y_continuous(trans='log10') + #Log10 scale
geom_smooth(method = "lm", formula = y ~ x) +
theme_classic() +
theme_linedraw()+
theme(text = element_text(family = "Times New Roman", color = "black", size = 10))+
labs(y = "7-epizingiberene (ion counts)", x = "alpha-pinene (ion counts)") +
#geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3) +  #Adds labels
ggsave("Full_F2_Zingiberen vs pinene.jpg", device = "jpg", scale = 1, width = 12, height = 8, units = "cm", dpi = 300)
trichomes = read.csv(file= "/Users/Ruy/Documents/Zingiberene & Derivatives/Large F2 EZ/Trichomes/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
volatiles = read.csv(file = "/Users/Ruy/Documents/Zingiberene & Derivatives/Large F2 EZ/Volatiles EZ (full F2)/R analysis/GCMS_Leafwash_Full_F2_EZ.csv", header = T, stringsAsFactors = T)
homo = read.csv(file = "/Users/Ruy/Documents/Zingiberene & Derivatives/Large F2 EZ/Trichomes/homozygous_ZGB_genotypes_F2.csv", header = T, stringsAsFactors = T)
volatiles_VI = read.csv(file = "/Users/Ruy/Documents/Zingiberene & Derivatives/Large F2 EZ/Volatiles UvA/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T)
volatiles.homo = left_join(homo, volatiles, by = "genotype")
volatiles.homo.trichomes = inner_join(volatiles.homo, trichomes)
volatiles.homo.trichomes$genotype = as.factor(volatiles.homo.trichomes$genotype)
df = volatiles.homo.trichomes
acylsugars = trichomes = read.csv(file= "/Users/Ruy/Documents/Zingiberene & Derivatives/Large F2 EZ/Acylsugar measurments/20170408_Corrected emission all.csv", header = T, stringsAsFactors = T)
sum_type_VI = df %>% dplyr::group_by(genotype) %>% dplyr::summarise(., sum_type_VI = sum(type_VI))
sum_type_VI = inner_join(sum_type_VI, volatiles)
df2 = sum_type_VI %>% filter(., !sum_type_VI %in% c("11","12", "13", "14"))
df2$sum_type_VI = as.factor(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", formula = zingiberene ~ sum_type_VI )+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", formula = zingiberene ~ sum_type_VI )+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", formula = df2$zingiberene ~ df2$sum_type_VI )+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "glm", formula = df2$zingiberene ~ df2$sum_type_VI )+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "glm", formula = df2$zingiberene ~ df2$sum_type_VI )+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "glm")+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "glm" aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm" aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
#geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot()+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene))+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
df2$zingiberene = log(df2$zingiberene)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)
df2 = sum_type_VI %>% filter(., !sum_type_VI %in% c("11","12", "13", "14"))
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
sum_type_VI = df %>% dplyr::group_by(genotype) %>% dplyr::summarise(., sum_type_VI = sum(type_VI))
sum_type_VI = inner_join(sum_type_VI, volatiles)
df2 = sum_type_VI %>% filter(., !sum_type_VI %in% c("11","12", "13", "14"))
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
trichomes = read.csv(file= "Figure_2/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
trichomes = read.csv(file= "Figure_2/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
volatiles = read.csv(file = "Figure_2/GCMS_Leafwash_Full_F2_EZ.csv", header = T, stringsAsFactors = T)
homo = read.csv(file = "Figure_2/homozygous_ZGB_genotypes_F2.csv", header = T, stringsAsFactors = T)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T)
acylsugars = trichomes = read.csv(file= "Figure_2/20170408_Corrected emission all.csv", header = T, stringsAsFactors = T)
df = inner_join(volatiles.homo, trichomes)
df$genotype = as.factor(df$genotype)
volatiles.homo = left_join(homo, volatiles, by = "genotype")
df = inner_join(volatiles.homo, trichomes)
trichomes = read.csv(file= "Figure_2/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
volatiles = read.csv(file = "Figure_2/GCMS_Leafwash_Full_F2_EZ.csv", header = T, stringsAsFactors = T)
homo = read.csv(file = "Figure_2/homozygous_ZGB_genotypes_F2.csv", header = T, stringsAsFactors = T)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T)
volatiles.homo = left_join(homo, volatiles, by = "genotype")
df = inner_join(volatiles.homo, trichomes)
df$genotype = as.factor(df$genotype)
type_VI_ab_ad = df %>% dplyr::group_by(genotype) %>% dplyr::summarise(., sum_type_VI = sum(type_VI))
type_VI_ab_ad = inner_join(type_VI_ab_ad, volatiles)
df2 = type_VI_ab_ad %>% filter(., !sum_type_VI %in% c("11","12", "13", "14"))
View(df)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
library(tidyverse)
library(RColorBrewer)
trichomes = read.csv(file= "Figure_2/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
volatiles = read.csv(file = "Figure_2/GCMS_Leafwash_Full_F2_EZ.csv", header = T, stringsAsFactors = T, check.names = F)
homo = read.csv(file = "Figure_2/homozygous_ZGB_genotypes_F2.csv", header = T, stringsAsFactors = T)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F)
# Take only the volatile data from plants homozygous for zFPS/ZIS + P450
volatiles.homo = left_join(homo, volatiles, by = "genotype")
# Include the trichome couting data
df = inner_join(volatiles.homo, trichomes)
df$genotype = as.factor(df$genotype)
acylsugars = trichomes = read.csv(file= "Figure_2/20170408_Corrected emission all.csv", header = T, stringsAsFactors = T)
# Take the sum of abaxial / adaxial sites and join volatile data
type_VI_ab_ad = df %>% dplyr::group_by(genotype) %>% dplyr::summarise(., sum_type_VI = sum(type_VI))
type_VI_ab_ad = inner_join(type_VI_ab_ad, volatiles)
df2 = type_VI_ab_ad %>% filter(., !sum_type_VI %in% c("11","12", "13", "14")) # remove mistakes in trichome counting (i.e. a class can not exceed 10)
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
geom_smooth(method = "lm", aes(x =df2$sum_type_VI, y = df2$zingiberene), alpha = 0.2)+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(size = 0.75)+
ylim(NA, 500000)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.75)+
ylim(NA, 500000)
ggplot(sum, aes(x = sum_type_VI, y = zingiberene))+
geom_bar(aes(x = sum_type_VI, y = sum$zingiberene), stat= "identity", fill = "black") +
geom_point(data = df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_smooth(method = lm)+
geom_errorbar(aes(x = sum$sum_type_VI, ymin = sum$zingiberene - se, ymax = sum$zingiberene + se), width = 0.2)+
scale_x_continuous(breaks=c(1:10))+
ylim(NA, 400000)+
ylab("zingiberene (ion counts / leaflet)")+
xlab("trichome-density class")+
theme_bw()
ggplot(sum, aes(x = sum_type_VI, y = zingiberene))+
geom_bar(aes(x = sum_type_VI, y = sum$zingiberene), stat= "identity", fill = "black") +
geom_point(data = df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_smooth(method = lm)+
geom_errorbar(aes(x = sum$sum_type_VI, ymin = sum$zingiberene - se, ymax = sum$zingiberene + se), width = 0.2)+
scale_x_continuous(breaks=c(1:10))+
ylim(NA, 400000)+
ylab("zingiberene (ion counts / leaflet)")+
xlab("trichome-density class")+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene))+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.75)+
ylim(NA, 500000)+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey")+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.75)+
ylim(NA, 500000)+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey")+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey")+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
theme_bw()
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey")+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey")+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
ggsave(file = "Figure_4/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
p.box =
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
ggsave(file = "Figure_4/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
p.box =
df2$sum_type_VI = as.numeric(df2$sum_type_VI)
df2$zingiberene = as.numeric(df2$zingiberene)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
ggsave(file = "Figure_4/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
ggplot()
library(ggplot2)
ggsave(file = "Figure_4/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
p.box =
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
my.theme
ggsave(file = "Figure_4/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
ggsave(file = "Figure_2/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
ggsave(file = "Figure_2/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 4)
ggsave(file = "Figure_2/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 3, height = 3)
df2 %>% filter(!genotype %in% c("PI127826", "CV", "F1")) %>%
ggplot(., aes(sum_type_VI))+
stat_bin(binwidth = 1, colour = "grey")+
#geom_freqpoly(binwidth = 0.5, colour = "red")+
#xlim()+
#scale_x_continuous(breaks= 1) +
xlab("Trichome class")+
ylab("Frequence amongst F2 progeny")+
ggtitle("Distribution of 7-epizingiberen in a F2 population")+
my.theme
volatiles %>% dplyr::group_by(., genotype, group) %>% dplyr::summarise(., mean_zingiberene = mean(zingiberene)) %>% filter(genotype != "14830-144") %>%
ggplot(., aes(x = reorder(genotype, -mean_zingiberene),
y = mean_zingiberene, fill= group))+
geom_bar(stat = "identity")+
theme_bw()+
theme(text = element_text(),
axis.text.x = element_text(size = 3, angle = 90, colour = "black"))
ggplot(data = df2, aes(scale(log(df2$zingiberene+1))))+
stat_bin(binwidth = .2, colour = "grey")+
#geom_freqpoly(binwidth = 0.2, colour = "red")+
theme_bw()+
#xlim(-3.5, 3.5)+
xlab("7-epizingiberene / leaflet (log-scaled ion counts)")+
ylab("Frequence amongst F2 progeny")+
ggtitle("Distribution of 7-epizingiberen in a F2 population")
p.zingiberene.fullF2 =
ggplot(data = df2, aes(scale(log(df2$zingiberene+1))))+
stat_bin(binwidth = .2, colour = "grey")+
#geom_freqpoly(binwidth = 0.2, colour = "red")+
theme_bw()+
#xlim(-3.5, 3.5)+
xlab("7-epizingiberene / leaflet (log-scaled ion counts)")+
ylab("Frequence amongst F2 progeny")+
ggtitle("Distribution of 7-epizingiberen in a F2 population")+
my.theme
ggplot(data = df2, aes(scale(log(df2$zingiberene+1))))+
stat_bin(binwidth = .2, colour = "grey")+
#geom_freqpoly(binwidth = 0.2, colour = "red")+
theme_bw()+
#xlim(-3.5, 3.5)+
xlab("7-epizingiberene / leaflet (log-scaled ion counts)")+
ylab("Frequence amongst F2 progeny")+
ggtitle("Distribution of 7-epizingiberen in a F2 population")+
my.theme
ggplot(data = df2, aes(scale(log(df2$zingiberene+1))))+
stat_bin(binwidth = .2, colour = "grey")+
#geom_freqpoly(binwidth = 0.2, colour = "red")+
theme_bw()+
#xlim(-3.5, 3.5)+
xlab("7-epizingiberene / leaflet (log-scaled ion counts)")+
ylab("Frequence amongst F2 progeny")+
my.theme
ggsave(file = "Figure_2/plots/zingiberene_full_F2_histogram.svg", plot = p.box, width = 3, height = 3)
p.zingiberene.fullF2 =
ggplot(data = df2, aes(scale(log(df2$zingiberene+1))))+
stat_bin(binwidth = .2, colour = "grey")+
#geom_freqpoly(binwidth = 0.2, colour = "red")+
theme_bw()+
#xlim(-3.5, 3.5)+
xlab("7-epizingiberene / leaflet (log-scaled ion counts)")+
ylab("Frequence amongst F2 progeny")+
my.theme
ggsave(file = "Figure_2/plots/zingiberene_full_F2_histogram.svg", plot = p.zingiberene.fullF2, width = 3, height = 3)
ggsave(file = "Figure_2/plots/zingiberene_full_F2_histogram.svg", plot = p.zingiberene.fullF2, width = 4, height = 3)
ggsave(file = "Figure_2/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 4, height = 3)
p.box =
ggplot(df2, aes(x = df2$sum_type_VI, y = df2$zingiberene))+
geom_boxplot(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene), fill = "grey", outlier.size = 0.5)+
geom_point(aes(x = as.factor(df2$sum_type_VI), y = df2$zingiberene),size = 0.5)+
ylim(NA, 500000)+
xlab(NULL)+
ylab("7-epizingiberene (ion counts / leaflet")+
xlab("Type-VI trichome-density class")+
my.theme
ggsave(file = "Figure_2/plots/type-VI_class_vs_zingiberene.svg", plot = p.box, width = 4, height = 3)
aov_class = aov(df2, zingiberene ~ sum_type_VI)
aov_class = aov(df2$zingiberene ~ df2$sum_type_VI)
summary(aov)
aov_class = aov(df2$zingiberene ~ log(df2$sum_type_VI))
summary(aov_class)
TK = TukeyHSD(oav_class)
TK = TukeyHSD(aov_class)
aov_class = aov(log(df2$zingiberene) ~ df2$sum_type_VI)
summary(aov_class)
TK = TukeyHSD(aov_class)
aov_class = aov(log(df2$zingiberene) ~ as.factor(df2$sum_type_VI))
summary(aov_class)
TK = TukeyHSD(aov_class)
TK
library(multcompView)
significant_groups = multcompLetters(TK[,4])
TK
significant_groups = multcompLetters(TK$`as.factor(df2$sum_type_VI)`[,4])
significant_groups
