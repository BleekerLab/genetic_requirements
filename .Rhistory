geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 18, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
df.parsed = df.long2 %>% filter(., df.long2$metabolite == "total_volatiles" & df.long2$trichome_position == "Type_VI_mm") %>% filter(., !genotype == "250")
str(df.long2)
df.parsed = df.long2 %>% filter(., df.long2$metabolite == "total_volatiles" & df.long2$trichome_position == "Type_VI_mm") %>% filter(., !sample == "250")
df.parsed$metabolite = as.factor(df.parsed$metabolite)
df.parsed$trichome_position = as.factor(df.parsed$trichome_position)
model  = lm(data = df.parsed, level ~ density)
summary(model)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
# Save plot
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
library(tidyverse)
library(RColorBrewer)
library(multcompView)
library(Rmisc)
#############################
# Custom theme for plotting #
#############################
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 7, angle = 45, hjust = 1, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F) %>% filter(., !genotype %in% c("LA1777", "PI127826xLA1777", "LA1777_F1", "CV_LA1777"))
trichomes = read.csv(file = "Figure_3/trichome_density_F2_selection.csv", header = T, stringsAsFactors = T, check.names = F)
# Summarise data and make a barplot
sum.volatiles = summarySE(volatiles_VI, measurevar = "total_volatiles", groupvars = c("genotype", "group"))
vol.log = approxfun(density((log(volatiles_VI$total_volatiles+1))))
plot(vol.log, xlim = c(-1.5,4.5), xlab = "scaled zingiberene content / type-VI trichome", ylab = "proportion of the F2 population")
abline(v = log(17.7+1)) # mean PI127826
abline(v = log(0.51+1)) # mean CV
abline(v = log(0.9 +1)) # mean F1
library(tidyverse)
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
trichomes = read.csv(file= "Figure_2/type_VI_trichomes_full_F2.csv", header = T, stringsAsFactors = T)
volatiles = read.csv(file = "Figure_2/GCMS_Leafwash_Full_F2_EZ.csv", header = T, stringsAsFactors = T, check.names = F)
homo = read.csv(file = "Figure_2/homozygous_ZGB_genotypes_F2.csv", header = T, stringsAsFactors = T)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F)
# Take only the volatile data from plants homozygous for zFPS/ZIS + P450
volatiles.homo = left_join(homo, volatiles, by = "genotype")
# Include the trichome couting data
df = inner_join(volatiles.homo, trichomes)
df$genotype = as.factor(df$genotype)
type_VI_ab_ad = df %>% dplyr::group_by(genotype) %>% dplyr::summarise(., sum_type_VI = sum(type_VI))
type_VI_ab_ad = inner_join(type_VI_ab_ad, volatiles)
df2 = type_VI_ab_ad %>% filter(., !sum_type_VI %in% c("11","12", "13", "14")) # remove mistakes in trichome counting (i.e. a class can not exceed 10)
View(volatiles)
View(volatiles)
volatiles.long = gather(volatiles,
key = "metabolite",
value = "value",
-sample, -genotype, -group)
ggplot(volatiles.long)+
geom_bar(stat = "sum", aes(x = genotype, y = value, fill = metabolite))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = genotype, y = value, fill = metabolite))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "grey","grey"))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,zingiberene), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,"zingiberene"), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
theme_blank()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
my.theme
volatiles.long$metabolite = factor(volatiles.long$metabolite, levels = c("B_phellandrene", "carene", "caryophyllene", "elemene", "ocymene", "pinene", "zingiberene", "zingiberenol", "epoxy-zingiberenol",
ordered = TRUE))
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","grey", "black","grey"))+
my.theme
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme+
theme(axis.text.x = ifelse(genotype %in% c("F1"), element_text(size = 12, colour = "black"),NULL))
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme+
theme(axis.text.x = ifelse("genotype" %in% c("F1"), element_text(size = 12, colour = "black"),NULL))
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme+
theme(axis.text.x = ifelse(volatiles.long$genotype %in% c("F1"), element_text(size = 12, colour = "black"),NULL))
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme+
theme(axis.text.x = ifelse(volatiles.long$genotype == "F1", element_text(size = 12, colour = "black"),NULL))
volatiles$perc.zingi = (volatiles$zingiberene / volatiles$carene)*100
volatiles$perc.zingi
volatiles$total = rowsum(volatiles[,4:9])
volatiles$total = colsum(volatiles[,4:9])
volatiles$total = colSums(volatiles[,4:9])
volatiles$total = colSums(volatiles[,4:8])
volatiles$total = colSums(volatiles[,3:8])
volatiles$total = colSums(volatiles[,4:8])
View(volatiles)
volatiles$perc.zingi = (volatiles$zingiberene / volatiles$total)*100
volatiles$perc.zingi = (volatiles$zingiberene / volatiles$total)
View(volatiles_VI)
View(volatiles)
volatiles$perc.zingi = (volatiles$zingiberene / volatiles$total)*100
View(type_VI_ab_ad)
View(trichomes)
View(volatiles)
volatiles$total = colSums(volatiles[,4:9])
volatiles$total = colSums(volatiles[,4:9], na.rm = T)
volatiles$total = colSums(volatiles[,4:9], na.rm = F)
p.bar =
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme +
ylab("Summed volatiles (ion counts / leaflet)")+
xlab("F2 progeny")
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 1, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme +
ylab("Summed volatiles (ion counts / leaflet)")+
xlab("F2 progeny")
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.hist, height = 4, width = 12)
p.bar =
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme +
ylab("Summed volatiles (ion counts / leaflet)")+
xlab("F2 progeny")
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.hist, height = 4, width = 12)
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.bar, height = 4, width = 12)
View(df)
volatiles.long = gather(volatiles.homo,
key = "metabolite",
value = "value",
-sample, -genotype, -group)
volatiles.long$metabolite = factor(volatiles.long$metabolite, levels = c("B_phellandrene", "carene", "caryophyllene", "elemene", "ocymene", "pinene", "zingiberene", "zingiberenol", "epoxy-zingiberenol",
ordered = TRUE))
ggplot(volatiles.long)+
geom_bar(stat = "identity", aes(x = reorder(genotype, -value,sum), y = value, fill = metabolite))+
scale_fill_manual(values = c("grey", "grey","grey", "grey","grey", "grey","black", "black","black"))+
my.theme +
ylab("Summed volatiles (ion counts / leaflet)")+
xlab("F2 progeny")
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.bar, height = 4, width = 12)
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.bar, height = 4, width = 8)
ggplot(volatiles.long)+
geom_point(aes(x = zingiberene, y = elemene))+
my.theme
ggplot(volatiles)+
geom_point(aes(x = zingiberene, y = elemene))+
my.theme
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene), y = log(elemene)))+
my.theme
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene), y = log(caryophyllene)))+
my.theme
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene), y = log(caryophyllene)))+
my.theme+
xlime(0,10)+
ylim(0,15)
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene), y = log(caryophyllene)))+
my.theme+
xlim(0,10)+
ylim(0,15)
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
my.theme+
xlim(0,10)+
ylim(0,15)
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
my.theme
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_smooth(method = "lm", y~x)
ggplot(volatiles)+
geom_point(aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_smooth(method = "lm", formula = y~x)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
my.theme
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
model  = lm(data = volatiles, log(caryophyllene+1) ~ log(zingiberene+1))
summary(model)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 4, y = 7.5,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 14, y = 10,
label = "r^2=",
size = 3)+
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2=",
size = 3)+
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^ 2=",
size = 3)+
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 3)+
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.5, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme
p.caryophyllene =
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("2-Caryophyllene (Log10-scaled ion counts / leaflet)")
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(caryophyllene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("2-Caryophyllene (Log10-scaled ion counts / leaflet)")
View(volatiles)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(pinene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("a-pinene (Log10-scaled ion counts / leaflet)")
model2  = lm(data = volatiles, log(pinene+1) ~ log(zingiberene+1))
summary(model2)
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(pinene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model2)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("a-pinene (Log10-scaled ion counts / leaflet)")
p.pinene =
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(pinene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 10,
label = round(summary(model2)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 10,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("a-pinene (Log10-scaled ion counts / leaflet)")
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(pinene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 6,
label = round(summary(model2)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 6,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("a-pinene (Log10-scaled ion counts / leaflet)")
p.pinene =
ggplot(volatiles, aes(x = log(zingiberene+1), y = log(pinene+1)))+
geom_point()+
geom_smooth(method = "lm", formula = y~x)+
annotate(geom = "text", x = 14.7, y = 6,
label = round(summary(model2)$adj.r.squared, digits= 3),
size = 2) +
annotate(geom = "text", x = 14.2, y = 6,
label = "r^2 =",
size = 2)+
my.theme+
xlab("7-epizingiberene (Log10-scaled ion counts / leaflet)")+
ylab("a-pinene (Log10-scaled ion counts / leaflet)")
ggsave("Figure_S3/zingiberene_vs_caryophyllene.svg", plot = p.caryophyllene, height = 4, width = 4)
ggsave("Figure_S3/zingiberene_vs_pinene.svg", plot = p.pinene, height = 4, width = 4)
ggsave("Figure_S3/Barplot_volatiles_Full_F2.svg", plot = p.bar, height = 4, width = 10)
