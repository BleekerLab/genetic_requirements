View(mean.trichomes.sum.volatiles)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F) %>% filter(., !genotype %in% c("LA1777", "PI127826xLA1777", "LA1777_F1", "CV_LA1777"))
trichomes = read.csv(file = "Figure_3/trichome_density_F2_selection.csv", header = T, stringsAsFactors = T, check.names = F)
View(volatiles_VI)
View(trichomes)
View(volatiles_VI)
View(volatiles_VI)
View(trichomes)
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F) %>% filter(., !genotype %in% c("LA1777", "PI127826xLA1777", "LA1777_F1", "CV_LA1777"))
trichomes = read.csv(file = "Figure_3/trichome_density_F2_selection.csv", header = T, stringsAsFactors = T, check.names = F)
###########################
# Zingiberene per type- VI#
sum.volatiles = summarySE(volatiles_VI, measurevar = "total_volatiles", groupvars = c("genotype", "group"))
View(volatiles_VI)
mean.trichomes = trichomes %>% dplyr::group_by(., genotype) %>% dplyr::summarise(., mean(type_VI_mm2))
mean.trichomes.sum.volatiles = inner_join(mean.trichomes, volatiles_VI, by = "genotype")
View(mean.trichomes.sum.volatiles)
View(volatiles_VI)
mean.volatiles = volatiles_VI %>% dplyr::group_by(., group, genotype) %>% dplyr::summarise(., mean(total_volatiles))
View(mean.trichomes)
View(volatiles_VI)
mean.volatiles = volatiles_VI %>% dplyr::group_by(., genotype) %>% dplyr::summarise(., mean(total_volatiles))
mean.trichomes.sum.volatiles = inner_join(mean.trichomes, mean.volatiles, by = "genotype")
View(mean.trichomes.sum.volatiles)
ggplot(sum.volatiles, x = reorder(genotype, -total_volatiles), y = total_volatiles)+
geom_bar(stat = "identity", aes(x =reorder(genotype, -total_volatiles), y = total_volatiles, fill = group))+
geom_errorbar(aes(x = genotype, ymin = total_volatiles - se, ymax = total_volatiles + se))+
scale_fill_manual(values = c("gray28", "lightgrey", "gray52", "black"))+
xlab(NULL)+
ylab("Summed terpenes (ng / type-VI trichome)")+
my.theme + theme(legend.position = "none")
ggsave("Figure_3/barplot_total_volatiles_type_VI.svg", plot = p.volatiles, height = 4, width = 7)
ggplot(mean.trichomes.sum.volatiles,
aes(x = mean.trichomes.sum.volatiles$`mean(type_VI_mm2)`,
y = mean.trichomes.sum.volatiles$total_volatiles_mean))+
geom_point()+
ylab("Volatiles per type-VI gland (ng / gland)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=mean.trichomes.sum.volatiles$genotype),hjust=1.5, vjust=0.5, size = 2)+
my.theme
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 7, angle = 45, hjust = 1, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
ggplot(mean.trichomes.sum.volatiles,
aes(x = mean.trichomes.sum.volatiles$`mean(type_VI_mm2)`,
y = mean.trichomes.sum.volatiles$total_volatiles_mean))+
geom_point()+
ylab("Volatiles per type-VI gland (ng / gland)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=mean.trichomes.sum.volatiles$genotype),hjust=1.5, vjust=0.5, size = 2)+
my.theme
View(mean.trichomes.sum.volatiles)
p.density.activity =
ggplot(mean.trichomes.sum.volatiles,
aes(x = mean.trichomes.sum.volatiles$`mean(type_VI_mm2)`,
y = mean.trichomes.sum.volatiles$`mean(total_volatiles)`))+
geom_point()+
ylab("Volatiles per type-VI gland (ng / gland)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=mean.trichomes.sum.volatiles$genotype),hjust=1.5, vjust=0.5, size = 2)+
my.theme
ggplot(mean.trichomes.sum.volatiles,
aes(x = mean.trichomes.sum.volatiles$`mean(type_VI_mm2)`,
y = mean.trichomes.sum.volatiles$`mean(total_volatiles)`))+
geom_point()+
ylab("Volatiles per type-VI gland (ng / gland)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=mean.trichomes.sum.volatiles$genotype),hjust=1.5, vjust=0.5, size = 2)+
my.theme
ggsave(file = "Figure_3/desnty_VS_acitivty.pdf", file = p.density.activity, height = 4, width = 4)
ggsave(file = "Figure_3/desnty_VS_acitivty.pdf", PLOT = p.density.activity, height = 4, width = 4)
ggsave(file = "Figure_3/desnty_VS_acitivty.pdf", plot = p.density.activity, height = 4, width = 4)
df <- read.csv(file = "20190115_ng_trichome_all.csv", header = TRUE)
df <- read.csv(file = "Figure_5/20190115_ng_trichome_all.csv", header = TRUE)
df <- read.csv(file = "Figure_5/20190115_ng_trichome_all.csv", header = TRUE, check.names = FALSE)
df$day = as.factor(df$day)
df[is.na(df)] = 0
df = df %>% filter(., genotype != "303")
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
View(df.long)
View(df)
df <- read.csv(file = "Figure_5/20190115_ng_trichome_all.csv", header = TRUE, check.names = FALSE)
df$day = as.factor(df$day)
df[is.na(df)] = 0
#Filter-out F2_303 because it doesn't have the P450
df = df %>% filter(., genotype != "303")
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
#Filter data
df.long %>% filter(.,
df.long$metabolite %in% c("total_MVA_terpenes", "total_MEP_terpenes") &
df.long$day == "14") %>%
df.long %>% filter(.,
df.long$metabolite %in% c("total_MVA_terpenes", "total_MEP_terpenes") &
df.long$day == "14")
df.long = df.long %>% filter(.,
df.long$metabolite %in% c("total_MVA_terpenes", "total_MEP_terpenes") &
df.long$day == "14")
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
df.long %>% filter(.,
df.long$treatment %in% c("control", "fosmidomycin") &
df.long$metabolite %in% c("total_MVA_terpenes", "total_MEP_terpenes") &
df.long$genotype == "PI127826" &
df.long$day == "14") %>%
#Boxplot
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_boxplot()+
facet_grid(genotype~metabolite, scale = "free") +
theme_classic() +
theme_linedraw() +
theme(text = element_text(family = "Times New Roman", color = "black", size = 8),
axis.text.x = element_text(size = 10, angle = 0),
plot.title = element_text(size = rel(2),hjust = 0.5),
strip.background = element_rect(colour="black", fill="grey"),
strip.text.x = element_text(size=8, colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(y = "Metabolite level (ng metabolite / type-VI trichome)")
df.long %>% filter(.,
df.long$treatment %in% c("control", "fosmidomycin") &
df.long$metabolite == "total_terpenes" &
df.long$genotype == "PI127826" &
df.long$day == "14") %>%
#Boxplot
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_boxplot()+
facet_grid(genotype~metabolite, scale = "free") +
theme_classic() +
theme_linedraw() +
theme(text = element_text(family = "Times New Roman", color = "black", size = 8),
axis.text.x = element_text(size = 10, angle = 0),
plot.title = element_text(size = rel(2),hjust = 0.5),
strip.background = element_rect(colour="black", fill="grey"),
strip.text.x = element_text(size=8, colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(y = "Metabolite level (ng metabolite / type-VI trichome)")
sum = summarySE(df.long,
measurevar = "level",
groupvars = c("genotype", "treatment", "day", "metabolite", "phenotype"))
View(sum)
View(sum)
sum %>% filter(.,
df.long$treatment %in% c("control", "fosmidomycin") &
df.long$metabolite == "total_terpenes" &
df.long$genotype == "PI127826" &
df.long$day == "14") %>%
sum %>% filter(.,
df.long$treatment %in% c("control", "fosmidomycin") &
df.long$metabolite == "total_terpenes" &
df.long$genotype == "PI127826" &
df.long$day == "14")
View(sum)
sum %>% filter(.,
df.long$treatment %in% c("control", "fosmidomycin") &
df.long$genotype == "PI127826" &
df.long$day == "14")
sum = summarySE(df.long,
measurevar = "level",
groupvars = c("genotype", "treatment", "day", "metabolite", "phenotype"))
write_csv(sum, "inhibitor_treatments_summary.csv")
str(sum)
sum %>% filter(.,
sum$metabolite %in% c("total_MVA_terpenes", "total_MEP_terpenes") &
sum$day == "14") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes") &
sum$day == "14") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes") &
sum$day == "14")
View(sum)
View(sum)
df <- read.csv(file = "Figure_5/20190115_ng_trichome_all.csv", header = TRUE, check.names = FALSE)
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
View(df.long)
df = df %>% filter(., genotype != "303")
#Make data tidy
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
sum = summarySE(df.long,
measurevar = "level",
groupvars = c("genotype", "treatment", "day", "metabolite", "phenotype"))
sum %>% filter(.,
sum$metabolite == "total_terpenes") &
sum$day == "14") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
View(df.long)
View(sum)
sum %>% filter(.,
sum$metabolite == "total_terpenes") &
sum$day == "14")
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = phenotype)) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
p.volatiles =
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
cavities <- read.csv(file = "Figure_5/20180808_Cavity volumes_14_days_treatment.csv", header = TRUE, check.names = FALSE)
View(cavities)
sum.cavities = summarySE(cavities,
measurevar = "volume_um",
groupvars = c("genotype", "treatment"))
View(sum.cavities)
sum.cavities %>% filter(.,
sum.cavities$treatment != "mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
library(multcompView)
library(ggplot2)
library(tidyverse)
library(Rmisc)
library(multcompView)
df <- read.csv(file = "Figure_5/20190115_ng_trichome_all.csv", header = TRUE, check.names = FALSE)
df$day = as.factor(df$day)
df[is.na(df)] = 0
#Filter-out F2_303 because it doesn't have the P450
df = df %>% filter(., genotype != "303")
#Make data tidy
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -genotype, -phenotype, -treatment,-day)
head(df.long)
df.long$metabolite = as.factor(df.long$metabolite)
df.long$level = as.numeric(df.long$level)
df.long$genotype = factor(df.long$genotype,
levels = c("PI127826", "73", "CV", "411"),
ordered = TRUE)
sum = summarySE(df.long,
measurevar = "level",
groupvars = c("genotype", "treatment", "day", "metabolite", "phenotype"))
#Filter data
p.volatiles =
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
##################
# Cavity volumes #
##################
cavities <- read.csv(file = "Figure_5/20180808_Cavity volumes_14_days_treatment.csv", header = TRUE, check.names = FALSE)
sum.cavities = summarySE(cavities,
measurevar = "volume_um",
groupvars = c("genotype", "treatment"))
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
p.volatiles =
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
##################
# Cavity volumes #
##################
cavities <- read.csv(file = "Figure_5/20180808_Cavity volumes_14_days_treatment.csv", header = TRUE, check.names = FALSE)
sum.cavities = summarySE(cavities,
measurevar = "volume_um",
groupvars = c("genotype", "treatment"))
p.cavities =
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
theme_bw()
library(gridExtra)
p.both = grid.arrange(p.volatiles, p.cavities, ncol = 2)
p.volatiles =
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
xlab("Volatiles")+
ylab("Total volatiles per type-VI gland (ng)")+
theme_bw()
p.cavities =
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
xlab("Storage cavity")+
ylab("Type-VI gland storage-cavity volume (um)")
p.both = grid.arrange(p.volatiles, p.cavities, ncol = 2)
p.cavities =
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
xlab("Storage cavity")+
ylab("Type-VI gland storage-cavity volume (um)")+
theme_bw()
p.both = grid.arrange(p.volatiles, p.cavities, ncol = 2)
ggsave("plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 3, height = 4)
ggsave("/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 3, height = 4)
ggsave(file = "Figure_4/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 3, height = 4)
ggsave(file = "Figure_4/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 4, height = 4)
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
ggsave(file = "Figure_4/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 5, height = 4)
p.volatiles =
sum %>% filter(.,
sum$metabolite == "total_terpenes" &
sum$day == "14" &
sum$treatment != "mevastatin" &
sum$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=level, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = level- se, ymax = level + se), width=0.1)+
#facet_grid(genotype~metabolite, scale = "free") +
xlab("Volatiles")+
ylab("Total volatiles per type-VI gland (ng)")+
my.theme
##################
# Cavity volumes #
##################
cavities <- read.csv(file = "Figure_5/20180808_Cavity volumes_14_days_treatment.csv", header = TRUE, check.names = FALSE)
sum.cavities = summarySE(cavities,
measurevar = "volume_um",
groupvars = c("genotype", "treatment"))
p.cavities =
sum.cavities %>% filter(.,
sum.cavities$treatment != "Mevastatin" &
sum.cavities$genotype == "PI127826") %>%
ggplot(., aes(x=treatment, y=volume_um, fill = "black")) +
geom_bar(stat = "identity", fill = "black")+
geom_errorbar(aes(ymin = volume_um- se, ymax = volume_um + se), width=0.1)+
xlab("Storage cavity")+
ylab("Type-VI gland storage-cavity volume (um)")+
my.theme
###################################
# Arrange both in 1 plot and save #
###################################
p.both = grid.arrange(p.volatiles, p.cavities, ncol = 2)
ggsave(file = "Figure_4/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 5, height = 4)
ggsave(file = "Figure_4/plots/fosmidomycin_PI127826_phenotypes.pdf", plot = p.both, width = 5, height = 3)
