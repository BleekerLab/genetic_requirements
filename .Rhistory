geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 4) +
annotate(geom = "text", x = 17, y = 320,
label = "r.squared = ",
size = 4)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 4) +
annotate(geom = "text", x = 19, y = 320,
label = "r.squared = ",
size = 4)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19, y = 320,
label = "r.squared = ",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 21, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3,
position=position_jitter(width=1,height=1))+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample), size = 3,
position=position_jitter(width=1,height=1))+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample), size = 3,
position=position_jitter(width=3,height=3))+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
xlim(0)+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
xlim(c(0:25)+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
# linear model
model  = lm(data = df.parsed, level ~ density)
summary(model)
model$qr
ggsave("Type_VI_trichomes_vs_zingiberene.svg", device = "svg", scale = 1, width = 12, height = 8, units = "cm", dpi = 300)
###PLOT TOTAL volatiles measured####
#Filter datafile on all volatiles and type_VI_trichomes both abaxial and adaxia
df.parsed = filter(df.long2, df.long2$metabolite == "All_volatiles" & df.long2$trichome_position == "Type_VI_mm")
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x) +
theme_classic() +
theme_linedraw()+
theme(text = element_text(family = "Times New Roman", color = "black", size = 10))+
labs(y = "Total terpenoids (ng / mg fresh leaf)", x = "Trichome-type VI density (trichomes / mm2)") +
# geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+ #Adds labels
ggsave("Type_VI_trichomes_vs_total_terpenes.jpg", device = "jpg", scale = 1, width = 12, height = 8, units = "cm", dpi = 300)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
xlim(c(0:25))+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
#############################
# Custom theme for plotting #
#############################
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 7, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
#############
# Load data #
#############
df = read.csv("Figure_3/Leafwash vs Trichome density.csv",header = TRUE, stringsAsFactors = T, check.names = FALSE)
#Change to long ('tidy') format. First the volatiles (df.long) and than also the trichomes (df.long2)
df.long = gather(
data = df,
key = "metabolite",
value = level,
-sample, -group, -Type_VI_mm2_Abaxial,-Type_VI_mm2_Adaxial,-Type_VI_mm)
df.long2 = gather(
data = df.long,
key = "trichome_position",
value = density,
-sample,-metabolite,-group,-level)
#Filter datafile on total_volatiles and type_VI_trichomes both abaxial and adaxial
df.parsed = filter(df.long2, df.long2$metabolite == "total_volatiles" & df.long2$trichome_position == "Type_VI_mm")
df.parsed$metabolite = as.factor(df.parsed$metabolite)
df.parsed$trichome_position = as.factor(df.parsed$trichome_position)
#Scatterplot
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 3)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 2)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 2)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point() +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 2) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 20.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 18, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
df.parsed = df.long2 %>% filter(., df.long2$metabolite == "total_volatiles" & df.long2$trichome_position == "Type_VI_mm") %>% filter(., !genotype == "250")
str(df.long2)
df.parsed = df.long2 %>% filter(., df.long2$metabolite == "total_volatiles" & df.long2$trichome_position == "Type_VI_mm") %>% filter(., !sample == "250")
df.parsed$metabolite = as.factor(df.parsed$metabolite)
df.parsed$trichome_position = as.factor(df.parsed$trichome_position)
model  = lm(data = df.parsed, level ~ density)
summary(model)
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
p.scatter =
ggplot(df.parsed, aes(x=density, y=level)) +
geom_point(size = 0.5) +
geom_smooth(method = "lm", formula = y ~ x, alpha  = 0.2) +
my.theme+
ylab("Summed terpenes (ng / mg fresh leaf)")+
xlab("Type-VI trichome density (trichomes / mm2)")+
geom_text(aes(label=df.parsed$sample),hjust=1.5, vjust=0.5, size = 1.5)+
annotate(geom = "text", x = 22, y = 320,
label = round(summary(model)$adj.r.squared, digits= 3),
size = 3) +
annotate(geom = "text", x = 19.5, y = 320,
label = "r^2=",
size = 3)
# Save plot
ggsave(file = "Figure_3/trichome_density_VS_leafwash.svg", plot = p.scatter, height = 4, width = 4)
library(tidyverse)
library(RColorBrewer)
library(multcompView)
library(Rmisc)
#############################
# Custom theme for plotting #
#############################
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 7, angle = 45, hjust = 1, colour = "black"),
axis.text.y = element_text(size = 8, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
volatiles_VI = read.csv(file = "Figure_2/type_VI_gland_terpenes_F2.csv", header = T, stringsAsFactors = T, check.names = F) %>% filter(., !genotype %in% c("LA1777", "PI127826xLA1777", "LA1777_F1", "CV_LA1777"))
trichomes = read.csv(file = "Figure_3/trichome_density_F2_selection.csv", header = T, stringsAsFactors = T, check.names = F)
# Summarise data and make a barplot
sum.volatiles = summarySE(volatiles_VI, measurevar = "total_volatiles", groupvars = c("genotype", "group"))
vol.log = approxfun(density((log(volatiles_VI$total_volatiles+1))))
plot(vol.log, xlim = c(-1.5,4.5), xlab = "scaled zingiberene content / type-VI trichome", ylab = "proportion of the F2 population")
abline(v = log(17.7+1)) # mean PI127826
abline(v = log(0.51+1)) # mean CV
abline(v = log(0.9 +1)) # mean F1
