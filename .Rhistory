library(tidyverse)
library(ggplot2)
library(Rmisc)
library(car)
############################
# Custom theme for plotting#
############################
my.theme =
theme(text = element_text(),
axis.text.x = element_text(size = 8, angle = 30, hjust = 1, colour = "black"),
strip.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(),
panel.background = element_rect(fill = NA, color = "black"),
strip.text.x = element_text(size=8, colour = "black")
)+
theme_bw()
#########################
# Import and shape data #
#########################
df = read.csv(file = "Figure_1_F1_phenotypes/F1_trichomes_densitites_CSV.csv", header = T, stringsAsFactors = T)
str(df)
df$leafdisc = as.factor(df$leafdisc)
# Make data tidy
df =
gather(data = df,
key = "type",
value = "density_mm2",
-genotype, - plant, -surface, -leafdisc, - date, -person)
df.wide =
spread(data = df,
key = "surface",
value = "density_mm2")
#Calculate avarage of ab/adaxial
df.wide$ab_ad = (df.wide$abaxial + df.wide$adaxial)/2
df.wide[is.na(df.wide)] = 0
df.long =
gather(data = df.wide,
key = "surface",
value = "density_mm2",
-genotype, - plant, -type, -leafdisc, - date, -person)
df.long$genotype = factor(df.long$genotype,
levels = c("Cultivar", "PI127826", "F1", "PI127826 x LA1777", "LA1777"),
ordered = TRUE)
#calculate averages over the two leafdiscs
se <- function(x) sd(x)/sqrt(length(x))
df.avg.leafdisc = df.long %>% dplyr::group_by(., genotype, plant, type, surface) %>%
dplyr::summarize(avg_value = mean(density_mm2), se = se(density_mm2)) %>% filter(., type != "sum_glandular")
# Plot the different types of trichomes (Average of adaxial / abaxial side)
df.avg.genotype = df.avg.leafdisc %>% filter(., type %in% c("non_glandular", "type_I_IV", "type_VI")) %>% filter(., surface %in% c("adaxial", "abaxial")) %>%
summarySE(., measurevar = "avg_value", groupvars = c("genotype", "type", "surface"))
p.all =
df.avg.genotype %>%
ggplot(., aes(x = genotype,
y = avg_value)) +
geom_bar(aes(x = genotype, y = avg_value), stat = "identity", fill = "black")+
geom_errorbar(aes(x = genotype, ymin = avg_value - se, ymax = avg_value+se), width = 0.2)+
facet_grid(type~surface, scale = "free")+
my.theme +
labs(x = NULL,
y = "Leaf-trichome desity (trichomes/mm2)")
# Plot only type-VI trichomes (Average of abaxial / adaxial side)
p.type_VI =
df.avg.genotype %>% filter(type == "type_VI") %>%
ggplot(., aes(x = genotype,
y = avg_value)) +
geom_bar(aes(x = genotype, y = avg_value), stat = "identity", fill = "black")+
geom_errorbar(aes(x = genotype, ymin = avg_value - se, ymax = avg_value+se), width = 0.2)+
facet_wrap(~surface, scale = "free", ncol = 1)+
my.theme +
labs(x = NULL,
y = "Leaf-trichome desity (trichomes/mm2)")
ggsave(file = "Figure_1_F1_phenotypes/plots/trichome_densities_F1.svg", plot = p.all, height = 12, width = 10)
ggsave(file = "Figure_1_F1_phenotypes/plots/type_VI_densities_F1.svg", plot = p.type_VI, height = 8, width = 5)
